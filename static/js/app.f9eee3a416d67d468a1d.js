webpackJsonp([1],{"/uW7":function(t,e){},"32Dp":function(t,e){},"3oAP":function(t,e){},"8JHL":function(t,e){},"9x6q":function(t,e){},AJtD:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("7+uW"),a=n("zL8q"),o=n.n(a),r=(n("tvR6"),{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]});var s=n("VU/8")({name:"App"},r,!1,function(t){n("jypu")},null,null).exports,l=n("/ocq"),c=n("d7EF"),u=n.n(c),f=n("//Fk"),d=n.n(f),m=n("5QVw"),p=n.n(m),h={"create-notification":"CreateNotification",notifications:"Notifications","user-profile":"UserProfile"},g={"/notifications":"1-notifications","/notifications/create":"2-create-notification","/user/profile":"3-user-profile"},v={name:"MenuNavigation",data:function(){var t=window.location.href.split("#")[1];return(t=g[t])||(t="1-notifications"),console.log(t),{activeIndex:t}},methods:{handleSelect:function(t,e){var n=t.split(/^\d+\-/gi)[1];if("logout"===n)return localStorage.removeItem("id_token"),void this.$router.push({name:"Login"});n="string"==typeof n&&h.hasOwnProperty(n)?h[n]:h.notifications,this.$router.push({name:n})}}},_={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"top-nav-menu"},[n("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex,mode:"horizontal"},on:{select:t.handleSelect}},[n("el-menu-item",{attrs:{index:"1-notifications"}},[t._v("Notifications")]),t._v(" "),n("el-submenu",{attrs:{index:"2"}},[n("template",{slot:"title"},[t._v("Workspace")]),t._v(" "),n("el-menu-item",{attrs:{index:"2-create-notification"}},[t._v("Create notification")])],2),t._v(" "),n("el-submenu",{style:{float:"right"},attrs:{index:"3"}},[n("template",{slot:"title"},[t._v("Settings")]),t._v(" "),n("el-menu-item",{attrs:{index:"3-user-profile"}},[t._v("User profile")]),t._v(" "),n("el-menu-item",{attrs:{index:"3-logout"}},[t._v("Logout")])],2)],1)],1)},staticRenderFns:[]};var y=n("VU/8")(v,_,!1,function(t){n("8JHL")},"data-v-8dbd049c",null).exports,b={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("i",{directives:[{name:"show",rawName:"v-show",value:this.is_showing,expression:"is_showing"}],staticClass:"el-icon-loading c-loader"})])},staticRenderFns:[]};var w=n("VU/8")({name:"Loader",props:["is_showing"],data:function(){return{}}},b,!1,function(t){n("32Dp")},"data-v-1f9dc5ae",null).exports,x={setAuth:function(){return i.default.axios.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("id_token"),this},get:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new d.a(function(n,a){i.default.axios.get("http://54.201.86.220/api/admin"+e).then(function(t){var e=t.data;if(!(200===t.status&&e instanceof Object&&(e.ok||e.errors instanceof Object)))throw new Error("Wrong GET query");n(e)}).catch(function(){t.$message.error("Unknown error"),a(new Error("Unknown error"))})})},post:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments[1];return new d.a(function(a,o){i.default.axios.post("http://54.201.86.220/api/admin"+e,n).then(function(t){var e=t.data;if(!(200===t.status&&e instanceof Object&&(e.ok||e.errors instanceof Object)))throw new Error("Wrong POST query");a(e)}).catch(function(){t.$message.error("Unknown error during data transfer"),o(new Error("Unknown error during data transfer"))})})},put:function(){},delete:function(){}},k={name:"Notifications",components:{MenuNavigation:y,Loader:w},created:function(){this.fetchNotifications()},methods:{handleSizeChange:function(t){this.perPage=t,this.currentPage=1,this.fetchNotifications()},handleCurrentChange:function(t){this.currentPage=t,this.fetchNotifications()},handleEdit:function(t,e){this.$router.push({name:"NotificationView",params:{id:e.id}})},handleDelete:function(t,e){var n=this,i=e.id;this.$confirm("This will permanently delete the notification. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){x.setAuth().get.call(n,"/notification/delete/"+i).then(function(t){n.notifications=n.notifications.filter(function(t){return+t.id!=+i}),n.$message({message:"Notification was removed successfully",type:"success"})}).catch(p.a)}).catch(p.a)},fetchNotifications:function(){var t=this,e=[],n=(this.currentPage-1)*this.perPage,i="/notification/list?limit="+this.perPage+"&offset="+n;this.done=!1,e.push(x.setAuth().get.call(this,i)),e.push(x.setAuth().get.call(this,"/notification/count")),d.a.all(e).then(function(e){var n=u()(e,2),i=n[0],a=n[1];t.done=!0,t.notifications=i.payload||[],t.totalCount=+a.payload||0}).catch(p.a).finally(function(){t.loading=!1})}},data:function(){return{done:!1,loading:!0,notifications:[],currentPage:1,totalCount:0,perPage:10}}},E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("menu-navigation"),t._v(" "),n("loader",{attrs:{is_showing:t.loading}}),t._v(" "),n("transition",{attrs:{name:"fade"}},[t.done?n("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.notifications}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{prop:"message",label:"Message"}}),t._v(" "),n("el-table-column",{attrs:{label:"Destination",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{trigger:"hover",placement:"top"}},[n("p",[t._v(t._s(e.row.link))]),t._v(" "),n("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[n("el-tag",{attrs:{size:"medium"}},[t._v("Link")])],1)])]}}])}),t._v(" "),n("el-table-column",{attrs:{width:"50",label:""}}),t._v(" "),n("el-table-column",{attrs:{property:"expired",label:"Expired",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{width:"155",label:"Operations"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){t.handleEdit(e.$index,e.row)}}},[t._v("Edit")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){t.handleDelete(e.$index,e.row)}}},[t._v("Delete")])]}}])})],1):t._e()],1),t._v(" "),t.totalCount>10?n("div",{staticClass:"block pgn-ntfs"},[n("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,15,25,50],"page-size":100,layout:"sizes, prev, pager, next",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e}}})],1):t._e()],1)},staticRenderFns:[]};var P=n("VU/8")(k,E,!1,function(t){n("jvrj")},"data-v-ddfddfa0",null).exports,$={},F={name:"Login",data:function(){return{formSending:!1,ruleForm:{username:"",pass:""},rules:{pass:[{validator:function(t,e,n){e?$ instanceof Object&&"string"==typeof $.pass?n(new Error($.pass)):n():n(new Error("Please input the password"))},trigger:"blur"}],username:[{validator:function(t,e,n){e?$ instanceof Object&&"string"==typeof $.username?n(new Error($.username)):n():n(new Error("Please input the username"))},trigger:"blur"}]}}},methods:{submitForm:function(t,e){var n=this;this.$refs.ruleForm.validate(function(i){if(!i)return!1;n.formSending=!0,x.post.call(n,"/user/login",{username:t,password:e}).then(function(t){if(!t.ok)return $=t.errors,n.$refs.ruleForm.validate(function(){$={}});localStorage.setItem("id_token",t.payload.id_token),n.$router.push({name:"Notifications"})}).catch(p.a).finally(function(){n.formSending=!1})})}}},N={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,"status-icon":"",rules:t.rules,"label-width":"120px"}},[n("div",{staticStyle:{margin:"0 auto",width:"200px","text-align":"center","margin-top":"42px","margin-bottom":"35px"}},[n("h2",[t._v("Sign in to Panel")])]),t._v(" "),n("div",{staticStyle:{border:"1px solid #ebebeb","border-radius":"3px",transition:".2s",padding:"30px 30px 4px 0px",width:"420px",margin:"0 auto"}},[n("el-form-item",{style:{marginLeft:"-17px"},attrs:{label:"Username",prop:"username"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:t.ruleForm.username,callback:function(e){t.$set(t.ruleForm,"username",e)},expression:"ruleForm.username"}})],1),t._v(" "),n("el-form-item",{style:{marginLeft:"-17px"},attrs:{label:"Password",prop:"pass"}},[n("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:t.ruleForm.pass,callback:function(e){t.$set(t.ruleForm,"pass",e)},expression:"ruleForm.pass"}})],1),t._v(" "),n("el-form-item",{style:{marginLeft:"-17px"}},[n("el-button",{attrs:{type:"primary",loading:t.formSending},on:{click:function(e){t.submitForm(t.ruleForm.username,t.ruleForm.pass)}}},[t._v("Sign in")])],1)],1)])},staticRenderFns:[]};var S=n("VU/8")(F,N,!1,function(t){n("/uW7")},"data-v-d7a84af6",null).exports,I={name:"NotificationForm",props:["notification","mode"],data:function(){return{imgInvalid:!1,selectedImage:null,rules:{header:[{validator:function(t,e,n){e?n():n(new Error("Please input the header"))},trigger:"blur"}],button:[{validator:function(t,e,n){e?n():n(new Error("Please input the button caption"))},trigger:"blur"}],link:[{validator:function(t,e,n){e?n():n(new Error("Please input the destination"))},trigger:"blur"}],company:[{validator:function(t,e,n){e?n():n(new Error("Please input the company name"))},trigger:"blur"}],priority:[{validator:function(t,e,n){e?/^\d+$/gi.test(e)?n():n(new Error("Wrong priority value")):n(new Error("Please input the priority"))},trigger:"blur"}],message:[{validator:function(t,e,n){e?n():n(new Error("Please input the message"))},trigger:"blur"}],expired:[{validator:function(t,e,n){e?n():n(new Error("Please input the expired date"))},trigger:"blur"}]}}},beforeMount:function(){if("edit"===this.mode){var t=this.notification.created_at+"000";if("Invalid Date"===(t=new Date(+t)).toString())return;var e=t.getMonth()+1,n=t.getDate();this.notification.created_at=t.getFullYear()+"-"+(e<10?"0"+e:e)+"-"+(n<10?"0"+n:n)}},mounted:function(){if("edit"===this.mode){var t=this.notification.image;document.getElementById("imagePreview").innerHTML='<img src="http://54.201.86.220/api/uploads/'+t+'">',this.selectedImage=t}},methods:{onUploadImage:function(){var t=this,e=document.getElementById("selectImage");e.click(),e.onchange=function(){var n=e.files[0],i=new FormData;i.append("image",n),fetch("http://54.201.86.220/api/admin/image/upload",{method:"POST",body:i,headers:{authorization:"Bearer "+localStorage.getItem("id_token")}}).then(function(t){return t.json()}).then(function(e){var n=e=e instanceof Object?e:{},i=n.ok,a=n.payload;if(!0!==i||"string"!=typeof a)throw new Error("Image not uploaded correctly");var o="http://54.201.86.220/api/uploads/"+a;t.selectedImage=a,t.imgInvalid=!1,document.getElementById("imagePreview").innerHTML='<img src="'+o+'">'}).catch(function(e){console.log(e),t.$message.error("Image was not uploaded. Try again")})}},onSave:function(){var t=this,e="/notification";"create"===this.mode?e+="/create":e+="/edit/"+this.notification.id,this.$refs.form.validate(function(n){var i=void 0;i=!("string"==typeof t.selectedImage&&t.selectedImage.length>0),t.imgInvalid=i;var a=t.notification.expired;if(a instanceof Date){var o=a.getMonth()+1,r=a.getDate();a=a.getFullYear()+"/"+(o<10?"0"+o:o)+"/"+(r<10?"0"+r:r)}else"string"==typeof a&&(a=(a=a.replace(/\-/g,"/")).split("/").map(function(t){return+t<10?"0"+t:t}).join("/"));if(!n||t.imgInvalid)return!1;var s=t.notification;x.setAuth().post.call(t,e,{message:s.message,image:t.selectedImage,header:s.header,priority:s.priority.toString(),expired:a,button:s.button,link:s.link,company:s.company}).then(function(e){if(!(e instanceof Object&&e.ok))throw new Error("Notification was not created");t.$router.push({name:"Notifications"}),t.$message({message:"Notification was created successfully",type:"success"})}).catch(p.a).finally(function(){})})},onCancel:function(){this.$router.push({name:"Notifications"})}}},C={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",{ref:"form",attrs:{rules:t.rules,model:t.notification,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"Header",prop:"header"}},[n("el-input",{model:{value:t.notification.header,callback:function(e){t.$set(t.notification,"header",e)},expression:"notification.header"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"Button",prop:"button"}},[n("el-input",{model:{value:t.notification.button,callback:function(e){t.$set(t.notification,"button",e)},expression:"notification.button"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"Destination",prop:"link"}},[n("el-input",{model:{value:t.notification.link,callback:function(e){t.$set(t.notification,"link",e)},expression:"notification.link"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"Company",prop:"company"}},[n("el-input",{model:{value:t.notification.company,callback:function(e){t.$set(t.notification,"company",e)},expression:"notification.company"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"Expired",prop:"expired"}},[n("el-col",{attrs:{span:11}},[n("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Pick an expired date"},model:{value:t.notification.expired,callback:function(e){t.$set(t.notification,"expired",e)},expression:"notification.expired"}})],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"Priority",prop:"priority"}},[n("el-input",{model:{value:t.notification.priority,callback:function(e){t.$set(t.notification,"priority",e)},expression:"notification.priority"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"Message",prop:"message"}},[n("el-input",{attrs:{type:"textarea"},model:{value:t.notification.message,callback:function(e){t.$set(t.notification,"message",e)},expression:"notification.message"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"Image"}},[n("form",{staticStyle:{display:"none"},attrs:{action:"",method:"post",enctype:"multipart/form-data"}},[n("input",{attrs:{type:"submit",value:"uploadImage",id:"uploadImage"}}),t._v(" "),n("input",{attrs:{type:"file",name:"image",id:"selectImage"}})]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.onUploadImage}},[t._v("Upload")]),t._v(" "),t.imgInvalid?n("div",{staticClass:"imgError"},[t._v("Please select the image")]):t._e(),t._v(" "),n("div",{staticStyle:{"margin-top":"23px"},attrs:{id:"imagePreview"}})],1),t._v(" "),"create"!=t.mode?n("el-form-item",{attrs:{label:"Created"}},[n("span",[t._v(t._s(t.notification.created_at))])]):t._e(),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.onSave}},[t._v("Save")]),t._v(" "),n("el-button",{on:{click:t.onCancel}},[t._v("Cancel")])],1)],1)},staticRenderFns:[]};var U=n("VU/8")(I,C,!1,function(t){n("TTfS")},"data-v-19870324",null).exports,A={name:"CreateNotification",components:{MenuNavigation:y,NotificationForm:U},data:function(){return{notification:{}}},methods:{}},j={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("menu-navigation"),this._v(" "),e("notificationForm",{attrs:{mode:"create",notification:this.notification}})],1)},staticRenderFns:[]};var D=n("VU/8")(A,j,!1,function(t){n("AJtD")},"data-v-43dec3e0",null).exports,L={name:"NotificationView",components:{MenuNavigation:y,Loader:w,NotificationForm:U},created:function(){this.fetchNotification()},methods:{fetchNotification:function(){var t=this,e=this.$route.params.id;x.setAuth().get.call(this,"/notification/get/"+e).then(function(e){t.done=!0;var n=e.payload.expired+"000",i=(n=new Date(+n)).getMonth()+1,a=n.getDate();n=n.getFullYear()+"-"+i+"-"+a,e.payload.expired=n,t.notification=e.payload}).catch(p.a).finally(function(){var e=document.getElementsByTagName("textarea")[0];e.style.height="150px",e.style["font-size"]="14px",e.style["font-family"]="'Avenir', Helvetica, Arial, sans-serif",t.loading=!1})}},data:function(){return{loading:!0,done:!1,notification:{}}}},T={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("menu-navigation"),this._v(" "),e("loader",{attrs:{is_showing:this.loading}}),this._v(" "),e("transition",{attrs:{name:"fade"}},[this.done?e("div",[e("notificationForm",{attrs:{mode:"edit",notification:this.notification}})],1):this._e()])],1)},staticRenderFns:[]};var M=n("VU/8")(L,T,!1,function(t){n("3oAP")},"data-v-02e6ffaa",null).exports,O={name:"UserProfile",components:{MenuNavigation:y},data:function(){return{}}},z={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("menu-navigation"),this._v(" "),e("span",[this._v("User Profile")])],1)},staticRenderFns:[]};var V=n("VU/8")(O,z,!1,function(t){n("9x6q")},"data-v-24438770",null).exports;i.default.use(l.a);var R=new l.a({routes:[{path:"/login",name:"Login",component:S,meta:{guest:!0}},{path:"/notifications",name:"Notifications",component:P,meta:{requiresAuth:!0}},{path:"/notifications/create",name:"CreateNotification",component:D,meta:{requiresAuth:!0}},{path:"/notifications/edit/:id",name:"NotificationView",component:M,meta:{requiresAuth:!0}},{path:"/user/profile",name:"UserProfile",component:V,meta:{requiresAuth:!0}}]});R.beforeEach(function(t,e,n){var i="string"==typeof localStorage.getItem("id_token");return"/login"!==t.path&&t.meta instanceof Object&&t.meta.requiresAuth&&!i?n({path:"/login",params:{nextUrl:t.fullPath}}):i&&"/login"===t.path?n({path:"/notifications"}):void n()});var q=R,B=n("mtWM"),W=n.n(B),H=n("Rf8U"),J=n.n(H),Y=n("wUZ8"),G=n.n(Y);i.default.use(J.a,W.a),i.default.use(o.a,{locale:G.a}),i.default.config.productionTip=!1,new i.default({el:"#app",router:q,components:{App:s},template:"<App/>"})},TTfS:function(t,e){},jvrj:function(t,e){},jypu:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.f9eee3a416d67d468a1d.js.map